""" Show a key overlay for presentations """
import re
import time

import curses
from math import floor

from .curses_defs import CursesLinePart
from .curses_window import CursesWindow

# These have been extracted from the 'univers'
# font in the pyfiglet package with an MIT license
# https://pypi.org/project/pyfiglet/0.7.4/
# See the license directory for the cooresponding license

# pylint: disable=too-many-lines

CHARS = {
    "33": ["    ", "88  ", "88  ", "88  ", "88  ", "88  ", '""  ', "aa  ", "88  ", "    ", "    "],
    "34": [
        "       ",
        "88 88  ",
        "88 88  ",
        '"" ""  ',
        "       ",
        "       ",
        "       ",
        "       ",
        "       ",
        "       ",
        "       ",
    ],
    "35": [
        "             ",
        "  88   88    ",
        "  88   88    ",
        "aa88aaa88aa  ",
        '""88"""88""  ',
        "aa88aaa88aa  ",
        '""88"""88""  ',
        "  88   88    ",
        "  88   88    ",
        "             ",
        "             ",
    ],
    "36": [
        "    8 8      ",
        " ad88888ba   ",
        'd8" 8 8 "8b  ',
        "Y8, 8 8      ",
        "`Y8a8a8a,    ",
        '  `"8"8"8b,  ',
        "    8 8 `8b  ",
        "Y8a 8 8 a8P  ",
        ' "Y88888P"   ',
        "    8 8      ",
        "             ",
    ],
    "37": [
        "                 ",
        ",adba,      ,d8  ",
        '8I  I8    ,d8"   ',
        '"fbdP\'  ,d8"     ',
        '      ,d8"       ',
        '    ,d8"         ',
        '  ,d8"   ,adba,  ',
        ',d8"     8I  I8  ',
        '8"       "fbdP\'  ',
        "                 ",
        "                 ",
    ],
    "38": [
        "              ",
        "   ,adba,     ",
        "   8I  I8     ",
        "   \"8bdP'     ",
        '  ,d8"8b  88  ',
        ".dP'   Yb,8I  ",
        "8P      888'  ",
        "8b,   ,dP8b   ",
        '`Y8888P"  Yb  ',
        "              ",
        "              ",
    ],
    "39": [
        "       ",
        "  d8'  ",
        " d8'   ",
        '""     ',
        "       ",
        "       ",
        "       ",
        "       ",
        "       ",
        "       ",
        "       ",
    ],
    "40": [
        "   a8  ",
        "  d8'  ",
        " d8'   ",
        "d8'    ",
        "88     ",
        "88     ",
        "Y8,    ",
        " Y8,   ",
        "  Y8,  ",
        '   "8  ',
        "       ",
    ],
    "41": [
        "8a     ",
        "`8b    ",
        " `8b   ",
        "  `8b  ",
        "   88  ",
        "   88  ",
        "  ,8P  ",
        " ,8P   ",
        ",8P    ",
        '8"     ',
        "       ",
    ],
    "42": [
        "              ",
        "              ",
        " I8a    a8I   ",
        '  "Yb,,dP"    ',
        "aaaa8888aaaa  ",
        '""""8888""""  ',
        "  ,dP'`Yb,    ",
        ' I8"    "8I   ',
        "              ",
        "              ",
        "              ",
    ],
    "43": [
        "            ",
        "            ",
        "    aa      ",
        "    88      ",
        "aaaa88aaaa  ",
        '""""88""""  ',
        "    88      ",
        '    ""      ',
        "            ",
        "            ",
        "            ",
    ],
    "44": [
        "      ",
        "      ",
        "      ",
        "      ",
        "      ",
        "      ",
        " aaa  ",
        ' "88  ',
        " d8'  ",
        '8"    ',
        "      ",
    ],
    "45": [
        "          ",
        "          ",
        "          ",
        "          ",
        "          ",
        "aaaaaaaa  ",
        '""""""""  ',
        "          ",
        "          ",
        "          ",
        "          ",
    ],
    "46": [
        "     ",
        "     ",
        "     ",
        "     ",
        "     ",
        "     ",
        "     ",
        "888  ",
        "888  ",
        "     ",
        "     ",
    ],
    "47": [
        "              ",
        "          d8  ",
        "        ,8P'  ",
        '       d8"    ',
        "     ,8P'     ",
        '    d8"       ',
        "  ,8P'        ",
        ' d8"          ',
        "8P'           ",
        "              ",
        "              ",
    ],
    "48": [
        "                ",
        "   ,a8888a,     ",
        ' ,8P"\'  `"Y8,   ',
        ",8P        Y8,  ",
        "88          88  ",
        "88          88  ",
        "`8b        d8'  ",
        " `8ba,  ,ad8'   ",
        '   "Y8888P"     ',
        "                ",
        "                ",
    ],
    "49": [
        "        ",
        "    88  ",
        "  ,d88  ",
        "888888  ",
        "    88  ",
        "    88  ",
        "    88  ",
        "    88  ",
        "    88  ",
        "        ",
        "        ",
    ],
    "50": [
        "             ",
        " ad888888b,  ",
        'd8"     "88  ',
        "        a8P  ",
        '     ,d8P"   ',
        '   a8P"      ',
        " a8P'        ",
        'd8"          ',
        "88888888888  ",
        "             ",
        "             ",
    ],
    "51": [
        "             ",
        " ad888888b,  ",
        'd8"     "88  ',
        "        a8P  ",
        '     aad8"   ',
        '     ""Y8,   ',
        '        "8b  ',
        "Y8,     a88  ",
        " \"Y888888P'  ",
        "             ",
        "             ",
    ],
    "52": [
        "               ",
        "        ,d8    ",
        "      ,d888    ",
        '    ,d8" 88    ',
        '  ,d8"   88    ',
        ',d8"     88    ',
        "8888888888888  ",
        "         88    ",
        "         88    ",
        "               ",
        "               ",
    ],
    "53": [
        "             ",
        "8888888888   ",
        "88           ",
        "88  ____     ",
        "88a8PPPP8b,  ",
        'PP"     `8b  ',
        "         d8  ",
        "Y8a     a8P  ",
        ' "Y88888P"   ',
        "             ",
        "             ",
    ],
    "54": [
        "             ",
        "  ad8888ba,  ",
        " 8P'    \"Y8  ",
        "d8           ",
        "88,dd888bb,  ",
        "88P'    `8b  ",
        "88       d8  ",
        "88a     a8P  ",
        ' "Y88888P"   ',
        "             ",
        "             ",
    ],
    "55": [
        "              ",
        "888888888888  ",
        "        ,8P'  ",
        '       d8"    ',
        "     ,8P'     ",
        '    d8"       ',
        "  ,8P'        ",
        ' d8"          ',
        "8P'           ",
        "              ",
        "              ",
    ],
    "56": [
        "             ",
        " ad88888ba   ",
        'd8"     "8b  ',
        "Y8a     a8P  ",
        ' "Y8aaa8P"   ',
        ' ,d8"""8b,   ',
        'd8"     "8b  ',
        "Y8a     a8P  ",
        ' "Y88888P"   ',
        "             ",
        "             ",
    ],
    "57": [
        "             ",
        " ad88888ba   ",
        'd8"     "88  ',
        "8P       88  ",
        "Y8,    ,d88  ",
        ' "PPPPPP"88  ',
        "         8P  ",
        "8b,    a8P   ",
        "`\"Y8888P'    ",
        "             ",
        "             ",
    ],
    "58": [
        "     ",
        "     ",
        "     ",
        "     ",
        "888  ",
        "888  ",
        "     ",
        "888  ",
        "888  ",
        "     ",
        "     ",
    ],
    "59": [
        "      ",
        "      ",
        "      ",
        "      ",
        " 888  ",
        ' """  ',
        " aaa  ",
        ' "88  ',
        " d8'  ",
        '8"    ',
        "      ",
    ],
    "60": [
        "           ",
        '      a8"  ',
        '    a8"    ',
        '  a8"      ',
        'a8"        ',
        '"8a        ',
        '  "8a      ',
        '    "8a    ',
        '      "8a  ',
        "           ",
        "           ",
    ],
    "61": [
        "            ",
        "            ",
        "            ",
        "8888888888  ",
        "            ",
        "8888888888  ",
        "            ",
        "            ",
        "            ",
        "            ",
        "            ",
    ],
    "62": [
        "           ",
        '"8a        ',
        '  "8a      ',
        '    "8a    ',
        '      "8a  ',
        '      a8"  ',
        '    a8"    ',
        '  a8"      ',
        'a8"        ',
        "           ",
        "           ",
    ],
    "63": [
        "             ",
        " ad88888ba   ",
        'd8"     "8b  ',
        '""      a8P  ',
        '     ,a8P"   ',
        '    d8"      ',
        '    ""       ',
        "    aa       ",
        "    88       ",
        "             ",
        "             ",
    ],
    "64": [
        "                  ",
        "  ,ad88PPP88ba,   ",
        ' d8"  .ama.a "8a  ',
        'd8\'  ,8P"88"  88  ',
        "88  .8P  8P   88  ",
        "88  88   8'   8P  ",
        "88  8B ,d8 ,ad8'  ",
        '"8a "88P"888P"    ',
        " `Y8aaaaaaaad8P   ",
        '    """""""""     ',
        "                  ",
    ],
    "65": [
        "                  ",
        "       db         ",
        "      d88b        ",
        "     d8'`8b       ",
        "    d8'  `8b      ",
        "   d8YaaaaY8b     ",
        '  d8""""""""8b    ',
        " d8'        `8b   ",
        "d8'          `8b  ",
        "                  ",
        "                  ",
    ],
    "66": [
        "             ",
        "88888888ba   ",
        '88      "8b  ',
        "88      ,8P  ",
        "88aaaaaa8P'  ",
        '88""""""8b,  ',
        "88      `8b  ",
        "88      a8P  ",
        '88888888P"   ',
        "             ",
        "             ",
    ],
    "67": [
        "               ",
        "  ,ad8888ba,   ",
        ' d8"\'    `"8b  ',
        "d8'            ",
        "88             ",
        "88             ",
        "Y8,            ",
        " Y8a.    .a8P  ",
        '  `"Y8888Y"\'   ',
        "               ",
        "               ",
    ],
    "68": [
        "               ",
        "88888888ba,    ",
        '88      `"8b   ',
        "88        `8b  ",
        "88         88  ",
        "88         88  ",
        "88         8P  ",
        "88      .a8P   ",
        "88888888Y\"'    ",
        "               ",
        "               ",
    ],
    "69": [
        "             ",
        "88888888888  ",
        "88           ",
        "88           ",
        "88aaaaa      ",
        '88"""""      ',
        "88           ",
        "88           ",
        "88888888888  ",
        "             ",
        "             ",
    ],
    "70": [
        "             ",
        "88888888888  ",
        "88           ",
        "88           ",
        "88aaaaa      ",
        '88"""""      ',
        "88           ",
        "88           ",
        "88           ",
        "             ",
        "             ",
    ],
    "71": [
        "               ",
        "  ,ad8888ba,   ",
        ' d8"\'    `"8b  ',
        "d8'            ",
        "88             ",
        "88      88888  ",
        "Y8,        88  ",
        " Y8a.    .a88  ",
        '  `"Y88888P"   ',
        "               ",
        "               ",
    ],
    "72": [
        "              ",
        "88        88  ",
        "88        88  ",
        "88        88  ",
        "88aaaaaaaa88  ",
        '88""""""""88  ',
        "88        88  ",
        "88        88  ",
        "88        88  ",
        "              ",
        "              ",
    ],
    "73": ["    ", "88  ", "88  ", "88  ", "88  ", "88  ", "88  ", "88  ", "88  ", "    ", "    "],
    "74": [
        "            ",
        "        88  ",
        "        88  ",
        "        88  ",
        "        88  ",
        "        88  ",
        "        88  ",
        "88,   ,d88  ",
        ' "Y8888P"   ',
        "            ",
        "            ",
    ],
    "75": [
        "              ",
        "88      a8P   ",
        "88    ,88'    ",
        '88  ,88"      ',
        "88,d88'       ",
        '8888"88,      ',
        "88P   Y8b     ",
        '88     "88,   ',
        "88       Y8b  ",
        "              ",
        "              ",
    ],
    "76": [
        "             ",
        "88           ",
        "88           ",
        "88           ",
        "88           ",
        "88           ",
        "88           ",
        "88           ",
        "88888888888  ",
        "             ",
        "             ",
    ],
    "77": [
        "                   ",
        "88b           d88  ",
        "888b         d888  ",
        "88`8b       d8'88  ",
        "88 `8b     d8' 88  ",
        "88  `8b   d8'  88  ",
        "88   `8b d8'   88  ",
        "88    `888'    88  ",
        "88     `8'     88  ",
        "                   ",
        "                   ",
    ],
    "78": [
        "              ",
        "888b      88  ",
        "8888b     88  ",
        "88 `8b    88  ",
        "88  `8b   88  ",
        "88   `8b  88  ",
        "88    `8b 88  ",
        "88     `8888  ",
        "88      `888  ",
        "              ",
        "              ",
    ],
    "79": [
        "                ",
        "  ,ad8888ba,    ",
        ' d8"\'    `"8b   ',
        "d8'        `8b  ",
        "88          88  ",
        "88          88  ",
        "Y8,        ,8P  ",
        " Y8a.    .a8P   ",
        '  `"Y8888Y"\'    ',
        "                ",
        "                ",
    ],
    "80": [
        "             ",
        "88888888ba   ",
        '88      "8b  ',
        "88      ,8P  ",
        "88aaaaaa8P'  ",
        '88""""""\'    ',
        "88           ",
        "88           ",
        "88           ",
        "             ",
        "             ",
    ],
    "81": [
        "                ",
        "  ,ad8888ba,    ",
        ' d8"\'    `"8b   ',
        "d8'        `8b  ",
        "88          88  ",
        "88          88  ",
        'Y8,    "88,,8P  ',
        " Y8a.    Y88P   ",
        '  `"Y8888Y"Y8a  ',
        "                ",
        "                ",
    ],
    "82": [
        "             ",
        "88888888ba   ",
        '88      "8b  ',
        "88      ,8P  ",
        "88aaaaaa8P'  ",
        '88""""88\'    ',
        "88    `8b    ",
        "88     `8b   ",
        "88      `8b  ",
        "             ",
        "             ",
    ],
    "83": [
        "             ",
        " ad88888ba   ",
        'd8"     "8b  ',
        "Y8,          ",
        "`Y8aaaaa,    ",
        '  `"""""8b,  ',
        "        `8b  ",
        "Y8a     a8P  ",
        ' "Y88888P"   ',
        "             ",
        "             ",
    ],
    "84": [
        "              ",
        "888888888888  ",
        "     88       ",
        "     88       ",
        "     88       ",
        "     88       ",
        "     88       ",
        "     88       ",
        "     88       ",
        "              ",
        "              ",
    ],
    "85": [
        "              ",
        "88        88  ",
        "88        88  ",
        "88        88  ",
        "88        88  ",
        "88        88  ",
        "88        88  ",
        "Y8a.    .a8P  ",
        ' `"Y8888Y"\'   ',
        "              ",
        "              ",
    ],
    "86": [
        "                 ",
        "8b           d8  ",
        "`8b         d8'  ",
        " `8b       d8'   ",
        "  `8b     d8'    ",
        "   `8b   d8'     ",
        "    `8b d8'      ",
        "     `888'       ",
        "      `8'        ",
        "                 ",
        "                 ",
    ],
    "87": [
        "                         ",
        "I8,        8        ,8I  ",
        "`8b       d8b       d8'  ",
        ' "8,     ,8"8,     ,8"   ',
        "  Y8     8P Y8     8P    ",
        "  `8b   d8' `8b   d8'    ",
        "   `8a a8'   `8a a8'     ",
        "    `8a8'     `8a8'      ",
        "     `8'       `8'       ",
        "                         ",
        "                         ",
    ],
    "88": [
        "              ",
        "8b        d8  ",
        " Y8,    ,8P   ",
        "  `8b  d8'    ",
        "    Y88P      ",
        "    d88b      ",
        "  ,8P  Y8,    ",
        " d8'    `8b   ",
        "8P        Y8  ",
        "              ",
        "              ",
    ],
    "89": [
        "              ",
        "8b        d8  ",
        " Y8,    ,8P   ",
        "  Y8,  ,8P    ",
        '   "8aa8"     ',
        "    `88'      ",
        "     88       ",
        "     88       ",
        "     88       ",
        "              ",
        "              ",
    ],
    "90": [
        "              ",
        "888888888888  ",
        "         ,88  ",
        '       ,88"   ',
        '     ,88"     ',
        '   ,88"       ',
        ' ,88"         ',
        '88"           ',
        "888888888888  ",
        "              ",
        "              ",
    ],
    "91": [
        "88888  ",
        "88     ",
        "88     ",
        "88     ",
        "88     ",
        "88     ",
        "88     ",
        "88     ",
        "88     ",
        "88888  ",
        "       ",
    ],
    "92": [
        "              ",
        "8b            ",
        "`Y8,          ",
        '  "8b         ',
        "   `P8,       ",
        '     "8b      ',
        "      `Y8,    ",
        '        "8b   ',
        "         `Y8  ",
        "              ",
        "              ",
    ],
    "93": [
        "88888  ",
        "   88  ",
        "   88  ",
        "   88  ",
        "   88  ",
        "   88  ",
        "   88  ",
        "   88  ",
        "   88  ",
        "88888  ",
        "       ",
    ],
    "94": [
        "     a       ",
        "   ,888,     ",
        ' ,d8P"Y8b,   ',
        'I8"     "8I  ',
        "             ",
        "             ",
        "             ",
        "             ",
        "             ",
        "             ",
        "             ",
    ],
    "95": [
        "              ",
        "              ",
        "              ",
        "              ",
        "              ",
        "              ",
        "              ",
        "              ",
        "              ",
        "              ",
        "888888888888  ",
    ],
    "96": [
        "       ",
        "`8b    ",
        " `8b   ",
        '   ""  ',
        "       ",
        "       ",
        "       ",
        "       ",
        "       ",
        "       ",
        "       ",
    ],
    "97": [
        "            ",
        "            ",
        "            ",
        "            ",
        ",adPPYYba,  ",
        '""     `Y8  ',
        ",adPPPPP88  ",
        "88,    ,88  ",
        '`"8bbdP"Y8  ',
        "            ",
        "            ",
    ],
    "98": [
        "             ",
        "88           ",
        "88           ",
        "88           ",
        "88,dPPYba,   ",
        "88P'    \"8a  ",
        "88       d8  ",
        '88b,   ,a8"  ',
        '8Y"Ybbd8"\'   ',
        "             ",
        "             ",
    ],
    "99": [
        "            ",
        "            ",
        "            ",
        "            ",
        " ,adPPYba,  ",
        'a8"     ""  ',
        "8b          ",
        '"8a,   ,aa  ',
        ' `"Ybbd8"\'  ',
        "            ",
        "            ",
    ],
    "100": [
        "             ",
        "         88  ",
        "         88  ",
        "         88  ",
        " ,adPPYb,88  ",
        'a8"    `Y88  ',
        "8b       88  ",
        '"8a,   ,d88  ',
        ' `"8bbdP"Y8  ',
        "             ",
        "             ",
    ],
    "101": [
        "            ",
        "            ",
        "            ",
        "            ",
        " ,adPPYba,  ",
        "a8P_____88  ",
        '8PP"""""""  ',
        '"8b,   ,aa  ',
        ' `"Ybbd8"\'  ',
        "            ",
        "            ",
    ],
    "102": [
        "         ",
        "   ad88  ",
        '  d8"    ',
        "  88     ",
        "MM88MMM  ",
        "  88     ",
        "  88     ",
        "  88     ",
        "  88     ",
        "         ",
        "         ",
    ],
    "103": [
        "             ",
        "             ",
        "             ",
        "             ",
        " ,adPPYb,d8  ",
        'a8"    `Y88  ',
        "8b       88  ",
        '"8a,   ,d88  ',
        ' `"YbbdP"Y8  ',
        " aa,    ,88  ",
        '  "Y8bbdP"   ',
    ],
    "104": [
        "             ",
        "88           ",
        "88           ",
        "88           ",
        "88,dPPYba,   ",
        "88P'    \"8a  ",
        "88       88  ",
        "88       88  ",
        "88       88  ",
        "             ",
        "             ",
    ],
    "105": ["    ", "88  ", '""  ', "    ", "88  ", "88  ", "88  ", "88  ", "88  ", "    ", "    "],
    "106": [
        "       ",
        "   88  ",
        '   ""  ',
        "       ",
        "   88  ",
        "   88  ",
        "   88  ",
        "   88  ",
        "   88  ",
        "  ,88  ",
        '888P"  ',
    ],
    "107": [
        "           ",
        "88         ",
        "88         ",
        "88         ",
        "88   ,d8   ",
        '88 ,a8"    ',
        "8888[      ",
        '88`"Yba,   ',
        "88   `Y8a  ",
        "           ",
        "           ",
    ],
    "108": ["    ", "88  ", "88  ", "88  ", "88  ", "88  ", "88  ", "88  ", "88  ", "    ", "    "],
    "109": [
        "                    ",
        "                    ",
        "                    ",
        "                    ",
        "88,dPYba,,adPYba,   ",
        '88P\'   "88"    "8a  ',
        "88      88      88  ",
        "88      88      88  ",
        "88      88      88  ",
        "                    ",
        "                    ",
    ],
    "110": [
        "             ",
        "             ",
        "             ",
        "             ",
        "8b,dPPYba,   ",
        "88P'   `\"8a  ",
        "88       88  ",
        "88       88  ",
        "88       88  ",
        "             ",
        "             ",
    ],
    "111": [
        "             ",
        "             ",
        "             ",
        "             ",
        " ,adPPYba,   ",
        'a8"     "8a  ',
        "8b       d8  ",
        '"8a,   ,a8"  ',
        ' `"YbbdP"\'   ',
        "             ",
        "             ",
    ],
    "112": [
        "             ",
        "             ",
        "             ",
        "             ",
        "8b,dPPYba,   ",
        "88P'    \"8a  ",
        "88       d8  ",
        '88b,   ,a8"  ',
        "88`YbbdP\"'   ",
        "88           ",
        "88           ",
    ],
    "113": [
        "             ",
        "             ",
        "             ",
        "             ",
        " ,adPPYb,d8  ",
        'a8"    `Y88  ',
        "8b       88  ",
        '"8a    ,d88  ',
        " `\"YbbdP'88  ",
        "         88  ",
        "         88  ",
    ],
    "114": [
        "            ",
        "            ",
        "            ",
        "            ",
        "8b,dPPYba,  ",
        "88P'   \"Y8  ",
        "88          ",
        "88          ",
        "88          ",
        "            ",
        "            ",
    ],
    "115": [
        "           ",
        "           ",
        "           ",
        "           ",
        ",adPPYba,  ",
        'I8[    ""  ',
        ' `"Y8ba,   ',
        "aa    ]8I  ",
        '`"YbbdP"\'  ',
        "           ",
        "           ",
    ],
    "116": [
        "         ",
        "         ",
        "  ,d     ",
        "  88     ",
        "MM88MMM  ",
        "  88     ",
        "  88     ",
        "  88,    ",
        '  "Y888  ',
        "         ",
        "         ",
    ],
    "117": [
        "             ",
        "             ",
        "             ",
        "             ",
        "88       88  ",
        "88       88  ",
        "88       88  ",
        '"8a,   ,a88  ',
        " `\"YbbdP'Y8  ",
        "             ",
        "             ",
    ],
    "118": [
        "             ",
        "             ",
        "             ",
        "             ",
        "8b       d8  ",
        "`8b     d8'  ",
        " `8b   d8'   ",
        "  `8b,d8'    ",
        '    "8"      ',
        "             ",
        "             ",
    ],
    "119": [
        "                    ",
        "                    ",
        "                    ",
        "                    ",
        "8b      db      d8  ",
        "`8b    d88b    d8'  ",
        " `8b  d8'`8b  d8'   ",
        "  `8bd8'  `8bd8'    ",
        "    YP      YP      ",
        "                    ",
        "                    ",
    ],
    "120": [
        "             ",
        "             ",
        "             ",
        "             ",
        "8b,     ,d8  ",
        " `Y8, ,8P'   ",
        "   )888(     ",
        ' ,d8" "8b,   ',
        "8P'     `Y8  ",
        "             ",
        "             ",
    ],
    "121": [
        "             ",
        "             ",
        "             ",
        "             ",
        "8b       d8  ",
        "`8b     d8'  ",
        " `8b   d8'   ",
        "  `8b,d8'    ",
        "    Y88'     ",
        "    d8'      ",
        "   d8'       ",
    ],
    "122": [
        "           ",
        "           ",
        "           ",
        "           ",
        "888888888  ",
        '     a8P"  ',
        "  ,d8P'    ",
        ',d8"       ',
        "888888888  ",
        "           ",
        "           ",
    ],
    "123": [
        "  ad888  ",
        "  88'    ",
        "  88     ",
        "  88     ",
        " ,8P     ",
        "88(      ",
        ' "8b     ',
        "  88     ",
        "  88     ",
        "  88,    ",
        '  "Y888  ',
    ],
    "124": ["    ", "88  ", "88  ", "88  ", "88  ", "    ", "88  ", "88  ", "88  ", "88  ", "    "],
    "125": [
        "888ba    ",
        "  `88    ",
        "   88    ",
        "   88    ",
        "   Y8,   ",
        "    )88  ",
        '   d8"   ',
        "   88    ",
        "   88    ",
        "  ,88    ",
        '888P"    ',
    ],
    "126": [
        "               ",
        "               ",
        "               ",
        "               ",
        " ad8bba,  ,aa  ",
        '""    ""Y8P"   ',
        "               ",
        "               ",
        "               ",
        "               ",
        "               ",
    ],
}

# end scope MIT license


class DemoMode(CursesWindow):
    # pylint: disable=too-few-public-methods
    """Functions specific to giving demos"""

    def __init__(self, screen, ui_config):
        super().__init__(ui_config=ui_config)
        self._screen = screen

    def show_key(self, string):
        """Show a single key on the screen"""

        if len(string) == 1 or string in ["^[", "KEY_NPAGE", "KEY_PPAGE"]:
            if string == "^[":
                string = "Esc"
            elif string == "KEY_NPAGE":
                string = "PgDn"
            elif string == "KEY_PPAGE":
                string = "PgUp"

            try:
                for char in string[0]:
                    lines = CHARS[str(ord(char))]
                for char in string[1:]:
                    for idx, line in enumerate(CHARS[str(ord(char))]):
                        lines[idx] = lines[idx] + line
            except KeyError:
                return

            # find the least number of right spaces in all lines
            right_trim = min(
                len(getattr(re.search(r"\s+$", line), "group", lambda: "")()) for line in lines
            )
            # find the least number of left spaces in all lines
            left_trim = min(
                len(getattr(re.search(r"^\s+", line), "group", lambda: "")()) for line in lines
            )
            # trim and pad all lines
            lines = [f" {line[left_trim:-right_trim]} " for line in lines]

            # find first and last lines that aren't all blanks
            first_line = [idx for idx, line in enumerate(lines) if line.strip()][0]
            last_line = (
                len(lines) - [idx for idx, line in enumerate(reversed(lines)) if line.strip()][0]
            )
            lines = lines[first_line:last_line]

            # pad the lines at top and bottom
            max_line = max(len(line) for line in lines)
            lines.insert(0, " " * max_line)
            lines.append(" " * max_line)

            # bail if screen not tall/wide enough
            if len(lines) > self._screen_h:
                return
            if max_line > self._screen_w:
                return

            # center the overlay
            top = floor((self._screen_h - len(lines)) / 2)
            left = floor((self._screen_w - max_line) / 2)
            for idx, line in enumerate(lines):
                curses_line = (CursesLinePart(left, line, 0, curses.A_BOLD),)
                self._add_line(self._screen, top + idx, curses_line)
            self._screen.refresh()
            time.sleep(0.2)
